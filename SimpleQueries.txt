SELECT PERSON.LName, PERSON.FName, PRESCRIPTIONS.Brand_name, PRESCRIPTIONS.Dosage, PRESCRIPTIONS.issued_Date FROM PATIENT_MEDRECORD
INNER JOIN PATIENT ON PATIENT.patient_ID = PATIENT_MEDRECORD.patient_ID
INNER JOIN PRESCRIPTIONS ON PRESCRIPTIONS.medRecord_ID = PATIENT_MEDRECORD.medRecord_ID
INNER JOIN PERSON ON PERSON.person_ID = PATIENT.person_ID
GROUP BY PERSON.LName, PERSON.FName
ORDER BY PERSON.Lname, PRESCRIPTIONS.Brand_name;

SELECT * FROM PATIENT
INNER JOIN INSURANCE ON INSURANCE.insurance_ID = PATIENT.insurance_ID
WHERE INSURANCE.Name = 'Delta Dental';

SELECT PROCEDURES.procedurename,APPOINTMENT.appointment_date FROM PROCEDURES
INNER JOIN INVOICE ON INVOICE.invoice_ID = PROCEDURES.invoice_ID
INNER JOIN APPOINTMENT_INVOICES ON APPOINTMENT_INVOICES.invoice_id = INVOICE.invoice_ID
INNER JOIN APPOINTMENT ON APPOINTMENT.appointment_id = APPOINTMENT_INVOICES.appointment_id
INNER JOIN MEDICAL ON MEDICAL.medical_ID = PROCEDURES.medical_ID
INNER JOIN EMPLOYEE ON EMPLOYEE.emp_id = MEDICAL.emp_id
INNER JOIN PERSON ON PERSON.person_ID = EMPLOYEE.person_ID
WHERE PERSON.Lname = 'Smilow';

SELECT INVOICE.invoice_ID, APPOINTMENT.appointment_date, PERSON.Fname, PERSON.Lname FROM INVOICE
INNER JOIN PATIENT ON PATIENT.patient_ID = INVOICE.patient_ID
INNER JOIN APPOINTMENT_INVOICES ON APPOINTMENT_INVOICES.invoice_id = INVOICE.invoice_ID
INNER JOIN APPOINTMENT ON APPOINTMENT.appointment_id = APPOINTMENT_INVOICES.invoice_id
INNER JOIN PERSON ON PERSON.person_id = PATIENT.person_ID
WHERE APPOINTMENT.appointment_date  < DateTime('Now', 'LocalTime', '-30 Day') AND (INVOICE.charge - INVOICE.paid > 10);

SELECT PERSON.Fname, PERSON.Lname, INVOICE.paid FROM INVOICE
INNER JOIN PATIENT ON PATIENT.patient_ID = INVOICE.patient_ID
INNER JOIN PERSON ON PERSON.person_id = PATIENT.person_ID
GROUP BY PERSON.Fname, PERSON.Lname
ORDER BY INVOICE.paid DESC
LIMIT 10;

SELECT M.medical_ID, PERSON.fname, PERSON.lname FROM MEDICAL AS M
LEFT OUTER JOIN PROCEDURES AS P ON M.medical_ID = P.medical_ID
INNER JOIN EMPLOYEE ON EMPLOYEE.emp_id = M.emp_ID
INNER JOIN PERSON ON PERSON.person_ID = EMPLOYEE.person_id
GROUP BY M.medical_ID
HAVING COUNT(P.procedure_ID) < 5;

SELECT P.procedure_ID, P.procedureName,P.charge, COUNT(P.procedure_ID) AS Count
FROM PROCEDURES AS P
ORDER BY P.charge;

SELECT I.Name  FROM PATIENT AS P
INNER JOIN INSURANCE AS I ON I.insurance_ID = P.insurance_ID
GROUP BY (I.Name)
ORDER BY COUNT(I.Name) DESC LIMIT 1;
